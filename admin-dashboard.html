<!DOCTYPE html>
<html>
<head>
    <title>Admin Dashboard</title>
    <style>
        body{font-family:Arial;background:#f4f4f4;padding:20px}
        .card{background:white;padding:15px;margin-bottom:10px;border-radius:8px;box-shadow:0 2px 5px rgba(0,0,0,0.1)}
        button{margin:5px;padding:8px 12px;border:none;border-radius:5px;cursor:pointer;color:white}
        .approve{background:#28a745}
        .complete{background:#007bff}
        .delete{background:#dc3545}
        .whatsapp{background:#25D366; text-decoration:none; display:inline-block; font-size:14px}
    </style>
</head>
<body>
    <h2>Admin Dashboard - Rajbahal Digital</h2>
    <div id="data">Loading appointments...</div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
        import { getDatabase, ref, onValue, update, remove } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-database.js";

        // Yahan apni purani details hi rehne dena
        const firebaseConfig = {
            apiKey: "AIzaSyAA36vfnM77LgCMJgjTHx8wsGYoBQHzXIQ", 
            authDomain: "education-c3132.firebaseapp.com",
            databaseURL: "https://education-c3132-default-rtdb.firebaseio.com",
            projectId: "education-c3132",
            storageBucket: "education-c3132.appspot.com",
            messagingSenderId: "1024541965642",
            appId: "1:1024541965642:web:e778014d245a9c3e2195b3"
        };

        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);

        onValue(ref(db, "appointments"), (snapshot)=>{
            const container = document.getElementById("data");
            container.innerHTML = "";
            snapshot.forEach((child)=>{
                const data = child.val();
                const key = child.key;
                
                // WhatsApp Link for Approval
                const waMsg = `Namaste ${data.name}, Rajbahal Digital ki taraf se aapka appointment APPROVE ho gaya hai.`;
                const waLink = `https://wa.me/91${data.phone}?text=${encodeURIComponent(waMsg)}`;

                container.innerHTML += `
                    <div class="card">
                        <b>Name:</b> ${data.name}<br>
                        <b>Phone:</b> ${data.phone}<br>
                        <b>Service:</b> ${data.service}<br>
                        <b>Status:</b> ${data.status || 'Pending'}<br>
                        <button class="approve" onclick="updateStatus('${key}', 'Approved')">Approve</button>
                        <a href="${waLink}" target="_blank" class="whatsapp" style="padding:8px 12px; border-radius:5px; color:white;">WhatsApp Msg âœ…</a>
                        <button class="complete" onclick="updateStatus('${key}', 'Completed')">Complete</button>
                        <button class="delete" onclick="deleteData('${key}')">Delete</button>
                    </div>
                `;
            });
        });

        window.updateStatus = function(key, status){
            update(ref(db, "appointments/"+key), {status: status});
        };

        window.deleteData = function(key){
            if(confirm("Delete karna chahte hain?")) {
                remove(ref(db, "appointments/"+key));
            }
        };
    </script>
</body>
</html>

